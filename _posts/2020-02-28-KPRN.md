---
layout:     post
title:      阅读笔记（一）
subtitle:   Explainable Reasoning over Knowledge Graphs for Recommendation
date:       2020-02-28
author:     Zbr
header-img: img/post-bg-2015.jpg
catalog: true
tags:
    - 知识图谱
    - 推荐系统
    - KPRN模型
---
## 背景

​	将辅助信息加入推荐系统是长期以来的研究方向，如用户画像、商品属性等。在知识图谱（KG）中，用户和商品的连接可以看作路径，这不仅可以解释解释为什么用户喜欢该商品，还可以揭示用户的喜好。因而将知识图谱纳入推荐系统具有重要意义。

* 整合KG路径上的信息可以使没有直接关联的推荐合理且可解释

* 从KG中已有的边可以揭示用户喜好

  因而作者提出了一种Knowledge-aware Path Recurrent Network模型（KPRN），该模型可以将主体（用户、商品）与关系的语义组合来获得路径表示，并利用路径的顺序依赖给出用户与商品交互的背后的原因。



## KPRN模型

#### 模型背景

> 知识图谱：KG是一个定向图，是（h,r,t）三元组的集合，其中h是头结点，t是尾节点，r为h与t的关系

> 用户商品交互数据：一般被表示成二分图，是（u,interact,i）三元组的集合，其中u是用户，i是商品，interact是用户和商品间的可观察的交互，如点击、评分、浏览后反馈

​	由于知识图谱中的主体包括用户和商品，将这两者按照商品的字符串匹配匹配合并，整合进一个浓缩的知识图谱，并作为模型的输入。

#### 通过路径分析用户偏好

​	用户1和歌曲b的关系可以由几个方向推导而来：

* 用户1听了歌曲a，然后歌曲a是专辑A的一首歌，歌曲b也是专辑A的歌，所以用户1->歌曲b

* 用户1听了歌曲a，然后歌曲a是歌手X的一首歌，歌曲b也是歌手X的歌，所以用户1->歌曲b

* 用户1听了歌曲a，然后用户2也听了歌曲a，用户2还听了歌曲b，所以用户1->歌曲b

  因此可以看出前两种的媒介是知识图谱中其他的商品，而第三种是CF方法，但是都得出了相同的结论。因此从推理的角度看，可以将知识图谱中的路径有权重地组合来预测特定用户对特定商品的交互。

#### 模型

​	输入为每个用户商品对的所有路径集合，输出为该用户和该商品产生交互的可能性的分数。整个模型有三个关键组成部分：

1. 嵌入层中每个都包含三个独立层：主体、主体类型、关系类型
2. LSTM层将这些元素顺序编码，目的是为了捕捉到这个路径上的主体们的组合语义
3. 权重池化层将多条路径结合，并输出给定用户对目标商品的最终分数



## 实验

#### 数据集

* Movie recommendation：采用MovieLens-1M和IMDb的结合，M1，其中MovieLens-1M提供用户商品交互数据，IMDb提供电影相关的辅助信息

* Music recommendation：采用KKBox数据集，此数据集中两种信息都有
* 如果有交互，就将用户商品对的值设为1，代表可见的正反馈，反之为0

###### 路径提取

​	由于长度在6以上的路径会产生噪声，所以限制路径提取长度在6以下。

#### 评价指标

* hit：评价top-K推荐的表现
* ndcg：评价用户喜好评分的表现

#### 对比方法

* **MF**：使用BPR作为loss函数的矩阵分解，仅利用用户商品交互
* **NFM**：将过往商品作为用户特征的最先进的分解模型
* **CKE**：整合了MF和TransR的特征的知识图谱嵌入模型
* **FMG**：最先进的基于元数据的模型，预定义各种类型的元图并使用MF对每个元图相似度矩阵做推荐
